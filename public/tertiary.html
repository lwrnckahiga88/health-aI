<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoloTailor AI - Advanced Foot Scanning</title>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
    <style>
        :root {
            --primary: #6d28d9;
            --primary-light: #8b5cf6;
            --secondary: #10b981;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #94a3b8;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f1f5f9;
            color: var(--dark);
            line-height: 1.6;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            margin-bottom: 2rem;
        }

        header h1 {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1.1rem;
            color: var(--gray);
        }

        .scan-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            border-radius: 0.5rem;
            overflow: hidden;
        }

        #camera-feed {
            width: 100%;
            display: block;
        }

        .scan-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .scanning-animation {
            width: 100%;
            height: 4px;
            background: rgba(255,255,255,0.3);
            margin-top: 1rem;
            position: relative;
            display: none;
        }

        .scanning-progress {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 0%;
            background: var(--secondary);
            transition: width 0.1s linear;
        }

        .foot-outline {
            width: 70%;
            height: 70%;
            border: 3px dashed rgba(255,255,255,0.8);
            border-radius: 20% 20% 50% 50%;
        }

        .scan-instructions {
            text-align: center;
            margin: 1rem 0 2rem;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-light);
        }

        .btn-secondary {
            background-color: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .processing-screen {
            text-align: center;
            padding: 2rem;
            display: none;
        }

        .spinner {
            width: 40px;
            height: 40px;
            margin: 1rem auto;
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .scan-complete {
            text-align: center;
            padding: 2rem;
            display: none;
        }

        .scan-complete svg {
            width: 48px;
            height: 48px;
            color: var(--secondary);
            margin-bottom: 1rem;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header>
            <h1>SoloTailor AI</h1>
            <p>Advanced 3D foot scanning technology</p>
        </header>

        <div class="scan-container">
            <video id="camera-feed" autoplay playsinline></video>
            <div class="scan-overlay">
                <div class="foot-outline"></div>
                <div class="scanning-animation">
                    <div class="scanning-progress"></div>
                </div>
            </div>
        </div>

        <div class="scan-instructions">
            <p>Position your foot within the outline and hold still</p>
            <button id="start-scan" class="btn btn-primary">Start Scanning</button>
        </div>

        <div class="processing-screen">
            <div class="spinner"></div>
            <h3>Processing Your Scan</h3>
            <p>Creating your 3D foot model...</p>
            <div id="processing-details" style="margin-top: 1rem;"></div>
        </div>

        <div class="scan-complete">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.59L9 16.17Z" fill="currentColor"/>
            </svg>
            <h3>Scan Complete!</h3>
            <p>Your 3D foot model has been successfully created</p>
            <button id="continue-btn" class="btn btn-primary" style="margin-top: 1rem;">Continue to Customization</button>
        </div>

        <div id="customization-section" class="hidden">
            <!-- Customization UI would go here -->
        </div>

    <script>
        // Camera and scanning variables
        let mediaStream;
        let scanInterval;
        let progress = 0;
        let processingStages = [
            "Capturing foot contours",
            "Analyzing arch structure",
            "Mapping pressure points",
            "Generating 3D model",
            "Calculating measurements"
        ];

        // Initialize camera
        async function initCamera() {
            try {
                mediaStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: 'environment',
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    } 
                });
                const videoElement = document.getElementById('camera-feed');
                videoElement.srcObject = mediaStream;
            } catch (err) {
                console.error("Camera error:", err);
                alert("Could not access camera. Please ensure you've granted camera permissions.");
                // Fallback to image upload
                document.querySelector('.scan-instructions').innerHTML = `
                    <p>Camera access denied. Please upload photos instead:</p>
                    <input type="file" id="foot-upload" accept="image/*" multiple style="display: none;">
                    <button class="btn btn-primary" onclick="document.getElementById('foot-upload').click()">Upload Foot Photos</button>
                `;
            }
        }

        // Start the scanning process
        function startScanning() {
            const startBtn = document.getElementById('start-scan');
            startBtn.textContent = 'Scanning...';
            startBtn.disabled = true;
            
            // Show scanning animation
            const scanningAnim = document.querySelector('.scanning-animation');
            const progressBar = document.querySelector('.scanning-progress');
            scanningAnim.style.display = 'block';
            
            // Simulate scanning progress
            progress = 0;
            scanInterval = setInterval(() => {
                progress += 1;
                progressBar.style.width = `${progress}%`;
                
                if (progress >= 100) {
                    completeScan();
                }
            }, 50);
        }

        // Complete the scanning process
        function completeScan() {
            clearInterval(scanInterval);
            
            // Hide camera and show processing
            document.getElementById('camera-feed').style.display = 'none';
            document.querySelector('.scan-overlay').style.display = 'none';
            document.querySelector('.scan-instructions').style.display = 'none';
            
            // Show processing screen
            const processingScreen = document.querySelector('.processing-screen');
            processingScreen.style.display = 'block';
            
            // Simulate processing stages
            let currentStage = 0;
            const detailsElement = document.getElementById('processing-details');
            
            const processingInterval = setInterval(() => {
                detailsElement.innerHTML += `<p>âœ“ ${processingStages[currentStage]}</p>`;
                currentStage++;
                
                if (currentStage >= processingStages.length) {
                    clearInterval(processingInterval);
                    showScanComplete();
                }
            }, 1500);
        }

        // Show scan complete screen
        function showScanComplete() {
            document.querySelector('.processing-screen').style.display = 'none';
            document.querySelector('.scan-complete').style.display = 'block';
        }

        // Continue to customization
        function continueToCustomization() {
            document.querySelector('.scan-complete').style.display = 'none';
            document.getElementById('customization-section').classList.remove('hidden');
            
            // In a real app, we would initialize the 3D customization view here
            alert("Now we would show the 3D customization interface with your scanned foot model");
        }

        // Clean up camera
        function stopCamera() {
            if (mediaStream) {
                mediaStream.getTracks().forEach(track => track.stop());
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            initCamera();
            
            document.getElementById('start-scan').addEventListener('click', startScanning);
            document.getElementById('continue-btn').addEventListener('click', continueToCustomization);
        });

        // Clean up when leaving page
        window.addEventListener('beforeunload', stopCamera);
    </script>
</body>
</html>
